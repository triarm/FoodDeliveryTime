unique(train_data$Cuisines)[1:10]
library(splitstackshape)
splitstackshape:::charMat(strsplit(train_data$Cuisines, ", "), fill = 0L)
unique(train_data$Average_Cost)
library(stringr)
gsub('[\u20b9]|,', '', train_data$Average_Cost) %>% as.numeric() %>%
unique()
unique(train_data$Minimum_Order)
gsub('[\u20b9]|,', '', train_data$Minimum_Order) %>% as.numeric() %>%
unique()
unique(train_data$Rating)
train_data$Rating %>% as.numeric() %>% unique()
unique(train_data$Votes)
train_data$Votes %>% as.numeric %>% unique()
unique(train_data$Reviews)
train_data$Reviews %>% as.numeric %>% unique()
unique(train_data$Delivery_Time)
gsub('[ minutes]', '', train_data$Delivery_Time) %>%  as.numeric() %>% unique()
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(Location,  function(x) transform_location(x)) %>% as.character()
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
train_data
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(Location,  function(x) transform_location(x))# %>% as.character()
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() #%>% sapply(Location,  function(x) transform_location(x))# %>% as.character()
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
train_data
juice(rec)
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(Location,  function(x) transform_location(x))# %>% as.character()
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(,  function(x) transform_location(x))# %>% as.character()
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(function(x) transform_location(x))# %>% as.character()
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
juice(rec)
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(function(x) transform_location(x))
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
juice(rec)
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(function(x) transform_location(x)),
Average_Cost = gsub('[\u20b9]|,', '', Average_Cost) %>% as.numeric()
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
juice(rec)
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(function(x) transform_location(x)),
Average_Cost = gsub('[\u20b9]|,', '', Average_Cost) %>% as.numeric(),
Minimum_Order = gsub('[\u20b9]|,', '', Minimum_Order) %>% as.numeric(),
Rating = as.factor(Rating)
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
juice(rec)
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(function(x) transform_location(x)),
Average_Cost = gsub('[\u20b9]|,', '', Average_Cost) %>% as.numeric(),
Minimum_Order = gsub('[\u20b9]|,', '', Minimum_Order) %>% as.numeric(),
Rating = as.numeric(Rating)
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
juice(rec)
View(train_data)
View(train_data)
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(function(x) transform_location(x)),
Average_Cost = gsub('[\u20b9]|,', '', Average_Cost) %>% as.numeric(),
Minimum_Order = gsub('[\u20b9]|,', '', Minimum_Order) %>% as.numeric(),
Rating = as.numeric(Rating)
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
juice(rec)
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(function(x) transform_location(x)),
Average_Cost = gsub('[\u20b9]|,', '', Average_Cost) %>% as.numeric(),
Minimum_Order = gsub('[\u20b9]|,', '', Minimum_Order) %>% as.numeric(),
Rating = as.numeric()
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(function(x) transform_location(x)),
Average_Cost = gsub('[\u20b9]|,', '', Average_Cost) %>% as.numeric(),
Minimum_Order = gsub('[\u20b9]|,', '', Minimum_Order) %>% as.numeric(),
Rating = as.numeric(Rating)
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
juice(rec)
train_data
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(function(x) transform_location(x)),
Average_Cost = gsub('[\u20b9]|,', '', Average_Cost) %>% as.numeric(),
Minimum_Order = gsub('[\u20b9]|,', '', Minimum_Order) %>% as.numeric(),
Rating = as.numeric(Rating),
Votes = as.numeric(Votes)
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
juice(rec)
train_data
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(function(x) transform_location(x)),
Average_Cost = gsub('[\u20b9]|,', '', Average_Cost) %>% as.numeric(),
Minimum_Order = gsub('[\u20b9]|,', '', Minimum_Order) %>% as.numeric(),
Rating = as.character(Rating) %>% as.numeric(),
Votes = as.numeric(Votes)
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
juice(rec)
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(function(x) transform_location(x)),
Average_Cost = gsub('[\u20b9]|,', '', Average_Cost) %>% as.numeric(),
Minimum_Order = gsub('[\u20b9]|,', '', Minimum_Order) %>% as.numeric(),
Rating = as.character(Rating) %>% as.numeric(),
Votes = as.numeric(Votes)
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep(strings_as_factors = FALSE)
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(function(x) transform_location(x)),
Average_Cost = gsub('[\u20b9]|,', '', Average_Cost) %>% as.numeric(),
Minimum_Order = gsub('[\u20b9]|,', '', Minimum_Order) %>% as.numeric(),
Rating = as.character(Rating) %>% as.numeric(),
Votes = as.numeric(Votes)
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
transform_location <- function(Location){
if(Location %in% c("Mumbai", "Mumbai CST Area" , "Mumbai Central")){
return ("Mumbai")
} else if(Location %in% c("Bangalore", "Electronic City", "Marathalli", "Whitefield")){
return("Bangalore")
} else if(Location %in% c("India Gate", "Delhi", "Delhi University-GTB Nagar", "Delhi Cantt." , "Timarpur", "Noida")){
return("Delhi")
} else if(Location %in% c("Gurgoan", "Gurgaon")){
return("Gurgaon")
} else if(Location %in% c("Maharashtra", "Pune", "Pune University")){
return("Maharashtra")
} else if(Location %in% c("Hyderabad", "Begumpet", "Majestic")){
return("Hyderabad")
} else if(Location %in% c("Kolkata")){
return("Kolkata")
}
}
rec <- recipe(Delivery_Time~., data = train_data) %>%
step_select(-Restaurant) %>%
step_mutate(
Location =  word(Location, -1, sep=",") %>% trimws() %>% sapply(function(x) transform_location(x)),
Average_Cost = gsub('[\u20b9]|,', '', Average_Cost) %>% as.numeric(),
Minimum_Order = gsub('[\u20b9]|,', '', Minimum_Order) %>% as.numeric(),
Rating = as.character(Rating) %>% as.numeric(),
Votes = as.character(Votes) %>% as.numeric(),
Reviews = as.character(Reviews) %>% as.numeric(),
Delivery_Time = gsub('[ minutes]', '', train_data$Delivery_Time) %>%  as.numeric()
) %>%
step_dummy_extract(Cuisines, sep= ", ") %>%
prep()
juice(rec)
rec
data_train <- juice(rec)
data_test <- bake(rec, test_data)
data_test <- bake(rec, test_data)
test_data
data_train <- juice(rec)
head(data_train)
